# 機能仕様書: 線形探索 (Linear Search) ページ

**機能ブランチ (Feature Branch)**: `001-linear-search`  
**作成日 (Created)**: 2025-11-27  
**ステータス (Status)**: Draft  
**入力 (Input)**: サンプルデザインを基にした線形探索の可視化ページ

## 概要

アルゴリズム学習サイトの最初のアルゴリズムページとして、線形探索（リニアサーチ）の動作を視覚的に理解できるページを作成する。配列の先頭から順番に要素をチェックしていく様子をアニメーションで表現し、ユーザーがステップ実行や自動再生で探索過程を追えるようにする。

## Clarifications

### Session 2025-11-28

- Q: ステップを1つ戻る「前へ」ボタンを実装しますか？ → A: はい、「前へ」ボタンを含める（サンプル通り）

## ユーザシナリオとテスト *(必須)*

### User Story 1 - 線形探索の動きを視覚的に理解する (Priority: P1)

アルゴリズム初学者として、線形探索がどのように配列を探索するのかを、アニメーションを通じて視覚的に理解したい。これにより、テキストだけでは掴みにくい「探索の流れ」を直感的に把握できる。

**この優先度である理由 (Why this priority)**:  
サイトの核心機能であり、「視覚で理解できる」というプロジェクトの目的を直接達成する。可視化がなければ、このサイトの存在意義がない。

**独立テスト方法 (Independent Test)**:  
ページを開き、再生ボタンを押すだけで、配列要素が順番にハイライトされ、目標値が見つかる（または見つからない）過程を目視で確認できる。

**受け入れ条件 (Acceptance Scenarios)**:

1. **Given** 配列と目標値が表示されている初期状態, **When** 再生ボタンをクリック, **Then** 配列の先頭から順番に要素がハイライトされ、目標値と比較される様子がアニメーションで表示される
2. **Given** 探索中の状態, **When** 目標値が見つかる, **Then** 該当要素が「発見」状態で強調表示され、探索が終了する
3. **Given** 探索中の状態, **When** 配列の最後まで探索しても目標値が見つからない, **Then** 「見つかりませんでした」というメッセージが表示される

---

### User Story 2 - ステップごとに探索過程を追う (Priority: P1)

学習者として、自分のペースで1ステップずつ探索を進めたい。これにより、各ステップで何が起きているのかをじっくり考えながら理解を深められる。

**この優先度である理由 (Why this priority)**:  
自動再生だけでは速すぎて理解が追いつかない学習者も多い。ステップ実行は「視覚で理解」を確実にするための必須機能。

**独立テスト方法 (Independent Test)**:  
「次へ」ボタンをクリックするたびに、探索が1ステップずつ進み、現在チェック中のインデックスと値が明示されることを確認できる。

**受け入れ条件 (Acceptance Scenarios)**:

1. **Given** 初期状態（ステップ0）, **When** 「次へ」ボタンをクリック, **Then** インデックス0の要素がハイライトされ、現在の値が表示される
2. **Given** ステップ1以上の状態, **When** 「前へ」ボタンをクリック, **Then** 1つ前のステップに戻り、ハイライト位置も戻る
3. **Given** 任意のステップ, **When** 「リセット」ボタンをクリック, **Then** 初期状態に戻り、すべてのハイライトがクリアされる
4. **Given** 再生中の状態, **When** 「一時停止」ボタンをクリック, **Then** アニメーションが停止し、現在のステップで止まる

---

### User Story 3 - 異なる配列で試す (Priority: P2)

学習者として、異なる配列データで線形探索を試したい。同じ例だけでなく、様々なパターンで動作を確認することで、アルゴリズムの一般的な動きを理解できる。

**この優先度である理由 (Why this priority)**:  
P1の可視化機能が完成してから追加すべき拡張機能。なくても最低限の学習は可能だが、理解を深めるために重要。

**独立テスト方法 (Independent Test)**:  
「新しい配列を生成」ボタンをクリックし、配列と目標値が変わることを確認できる。

**受け入れ条件 (Acceptance Scenarios)**:

1. **Given** 任意の状態, **When** 「新しい配列を生成」ボタンをクリック, **Then** ランダムな配列と目標値が生成され、画面がリセットされる
2. **Given** 新しい配列が生成された状態, **When** 再生を開始, **Then** 新しい配列で線形探索が実行される

---

### User Story 4 - アルゴリズムの理論を学ぶ (Priority: P2)

学習者として、線形探索の計算量や特性について理解したい。可視化だけでなく、なぜO(n)なのか、どのような場面で使うのかを知りたい。

**この優先度である理由 (Why this priority)**:  
可視化の補助として重要だが、可視化機能が先に完成している必要がある。

**独立テスト方法 (Independent Test)**:  
ページをスクロールし、Introduction、Code、Mathセクションが存在し、内容が読めることを確認できる。

**受け入れ条件 (Acceptance Scenarios)**:

1. **Given** ページを開いた状態, **When** Introductionセクションを確認, **Then** 線形探索の目的と使用場面が説明されている
2. **Given** ページを開いた状態, **When** Codeセクションを確認, **Then** TypeScriptによる実装例（10〜20行）が表示されている
3. **Given** ページを開いた状態, **When** Mathセクション（折り畳み）を展開, **Then** 時間計算量O(n)の説明が表示される

---

### User Story 5 - Playgroundで自由に試す (Priority: P3)

学習者として、任意の配列と目標値を自分で入力して線形探索を試したい。教材として用意されたデータだけでなく、自分で考えた例で実験することで理解を確実にしたい。

**この優先度である理由 (Why this priority)**:  
高度なインタラクティブ機能であり、基本的な可視化とステップ実行が完成してから着手すべき。MVP後の拡張として位置づける。

**独立テスト方法 (Independent Test)**:  
Playgroundページにアクセスし、配列と目標値を入力して探索を実行できることを確認する。

**受け入れ条件 (Acceptance Scenarios)**:

1. **Given** アルゴリズムページ, **When** Playgroundリンクをクリック, **Then** 線形探索のPlaygroundページに遷移する
2. **Given** Playgroundページ, **When** 配列と目標値を入力して実行, **Then** 入力したデータで線形探索が可視化される

---

### エッジケース (Edge Cases)

- **空の配列**: 要素がない配列で探索した場合、即座に「見つかりませんでした」と表示される
- **目標値が配列に複数存在**: 最初に見つかった位置で探索が終了する（仕様通り）
- **配列の先頭に目標値がある**: 1ステップで発見され、正しく表示される
- **配列の末尾に目標値がある**: 全要素をチェックしてから発見される
- **非常に大きな配列**: パフォーマンスへの影響（配列サイズの上限を設ける: 20要素程度を推奨）

## 要件 (Requirements) *(必須)*

### 機能要件 (Functional Requirements)

#### 可視化コンポーネント

- **FR-001**: システムは配列の各要素をボックスとして横並びに表示すること
- **FR-002**: 各ボックスには値とインデックスが表示されること
- **FR-003**: 現在チェック中の要素は視覚的に強調表示（黄色系のハイライト、拡大アニメーション）されること
- **FR-004**: 探索済みの要素はグレーアウトして表示されること
- **FR-005**: 目標値が発見された要素は緑色で強調表示されること
- **FR-006**: 各状態を示す凡例が表示されること

#### ステップ制御

- **FR-007**: ユーザーは「再生」ボタンで自動的に探索を進められること
- **FR-008**: ユーザーは「一時停止」ボタンで再生を停止できること
- **FR-009**: ユーザーは「次へ」ボタンで1ステップずつ進められること
- **FR-009a**: ユーザーは「前へ」ボタンで1ステップ戻れること（ステップ0では無効化）
- **FR-010**: ユーザーは「リセット」ボタンで初期状態に戻せること
- **FR-011**: 進捗状況（現在のステップ / 全ステップ数）が表示されること
- **FR-012**: プログレスバーで視覚的に進捗が表示されること

#### 探索情報表示

- **FR-013**: 目標値（探索対象の値）が明示的に表示されること
- **FR-014**: 現在チェック中の要素のインデックスと値が表示されること
- **FR-015**: 一致/不一致の判定結果がリアルタイムで表示されること
- **FR-016**: 探索完了時に結果メッセージ（発見位置または「見つかりませんでした」）が表示されること

#### 配列生成

- **FR-017**: 初期状態で固定の配列と目標値が表示されること
- **FR-018**: ユーザーは「新しい配列を生成」ボタンでランダムな配列を生成できること
- **FR-019**: 生成される配列は9要素程度、各値は1〜99の範囲であること
- **FR-020**: 目標値は配列内に存在する値からランダムに選ばれること（発見可能なケースを優先）

### アルゴリズムページ構造の要件

この機能はアルゴリズムページの作成を含むため、憲法の原則5に基づき、以下の構造要件を **必ず (MUST)** 満たすこと:

- **FR-ALG-001**: アルゴリズムページには Introduction セクション（1 画面で概要が分かる説明）を含めること
  - 線形探索の目的：「配列から目標値を見つける」
  - 入力例・出力例の提示
  - 想定される使用場面
- **FR-ALG-002**: Motion One を用いた Visualization セクションを含めること
  - 配列要素のハイライトアニメーション
  - チェック中の要素の拡大・移動アニメーション
  - 色変化によるステータス表現
- **FR-ALG-003**: `AlgorithmStep` コンポーネントを用いた Algorithm Flow セクション（ステップごとの分解）を含めること
  - 各ステップの説明が可視化と連動
- **FR-ALG-004**: TypeScript 実装を示す Code セクションを含め、10〜20 行程度・コメント最小限とすること
- **FR-ALG-005**: `<details>` 要素を用いた Math セクション（折り畳みの数学的補足）を含めること
  - 時間計算量 O(n) の説明
  - 最良・最悪・平均ケースの説明
- **FR-ALG-006**: 該当する場合、Playground ページへのリンクを含めること
- **FR-ALG-007**: すべてのコード例は TypeScript のみで記述し、C# を含む他言語を混在させないこと

### 主要エンティティ (Key Entities)

- **SearchStep**: 探索の1ステップを表すデータ
  - index: チェック中のインデックス位置
  - current: チェック中の値
  - found: 目標値と一致したかどうか

- **探索状態 (Search State)**: 可視化の現在の状態
  - 配列データ
  - 目標値
  - 現在のステップ位置
  - 再生中かどうか
  - 発見されたインデックス（あれば）

## 成功指標 (Success Criteria) *(必須)*

### 測定可能なアウトカム (Measurable Outcomes)

- **SC-001**: ユーザーがページを開いてから30秒以内に最初のアニメーション再生を開始できる
- **SC-002**: ステップ実行で配列の全要素（9要素）を順番にチェックする操作を1分以内に完了できる
- **SC-003**: 初めて線形探索を学ぶユーザーが、アニメーションを見た後に「どの要素から順番にチェックするか」を正しく説明できる
- **SC-004**: 「新しい配列を生成」を押してから1秒以内に新しい配列で探索を開始できる状態になる
- **SC-005**: ページのすべてのセクション（Introduction, Visualization, Algorithm Flow, Code, Math）が存在し、空でない内容が表示される

## 前提条件と依存関係 (Assumptions & Dependencies)

### 前提条件

- Astro プロジェクトがセットアップ済みであること
- TailwindCSS が利用可能であること
- Motion One（React版）がインストールされていること

### 依存関係

- 共通レイアウトコンポーネント（`Layout.astro`）が存在すること
- `AlgorithmStep` コンポーネントが実装されていること（なければ同時に作成）

## 範囲外 (Out of Scope)

- ユーザーが配列を直接編集する機能（Playgroundで対応）
- 二分探索など他の探索アルゴリズムとの比較機能
- モバイル向けの最適化（デスクトップファーストで実装）
- 多言語対応（日本語のみ）
- ユーザー認証・進捗保存機能
