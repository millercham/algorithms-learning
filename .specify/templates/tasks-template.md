---

description: "機能実装のためのタスクリストテンプレート"
---

# Tasks: [FEATURE NAME]

**入力 (Input)**: `/specs/[###-feature-name]/` 配下の設計ドキュメント  
**前提条件 (Prerequisites)**: plan.md（必須）, spec.md（ユーザーストーリーに必須）, research.md, data-model.md, contracts/

**テスト (Tests)**: 以下の例にはテストタスクが含まれるが、  
テストは **任意** であり、機能仕様で明示的に要求された場合のみ含めること。

**構成 (Organization)**:  
タスクはユーザーストーリー単位でグルーピングし、  
各ストーリーを独立して実装・テストできるようにする。

## フォーマット: `[ID] [P?] [Story] 説明`

- **[P]**: 並列実行可能（別ファイルで依存関係がないタスク）  
- **[Story]**: どのユーザーストーリーか（例: US1, US2, US3）  
- 説明には **正確なファイルパス** を含めること

## パス規約 (Path Conventions)

- **Astro プロジェクト**: `src/pages/`, `src/components/`, `src/styles/` がリポジトリルート配下  
- **アルゴリズムページ**: `src/pages/algorithms/[name].astro`  
- **Playground ページ**: `src/pages/playground/[name]/`  
- **静的コンポーネント**: `src/components/static/[Name].astro`  
- **Island コンポーネント（動的 TSX）**: `src/components/islands/[Name].tsx`  
- **アルゴリズムロジック（純 TS）**: `src/utils/math/[algo].ts`  
- **UI 補助ロジック**: `src/utils/ui/[name].ts`  
- ここで示すパスは Astro プロジェクト構造と Island アーキテクチャを前提としている。詳細は plan.md と `doc/specification.md` に合わせて調整すること。

<!-- 
  ============================================================================
  重要: 以下のタスクはあくまで「サンプル」であり、そのまま使ってはならない。
  
  /speckit.tasks コマンドは、以下の情報を元に実タスクへ置き換える必要がある:
  - spec.md に定義されたユーザーストーリー（優先度 P1, P2, P3 ...）
  - plan.md に定義された機能要件
  - data-model.md に定義されたエンティティ
  - contracts/ に定義されたエンドポイントや契約
  
  タスクは必ずユーザーストーリー単位で整理し、各ストーリーが:
  - 独立して実装でき
  - 独立してテストでき
  - 独立した MVP インクリメントとしてデリバリー可能
  になるようにする。
  
  生成された tasks.md に、このサンプルタスク群を残してはいけない。
  ============================================================================
-->

## フェーズ 1: セットアップ (共有インフラ)

**目的**: プロジェクトの初期化と基本構造の準備

- [ ] T001 実装計画 (plan.md) に従ったプロジェクト構造の作成  
- [ ] T002 Astro + TypeScript プロジェクトを初期化し、必要な依存関係  
       （TailwindCSS, Headless UI, Motion One, KaTeX, Prism.js）を追加  
- [ ] T003 [P] Lint / Formatter（例: ESLint, Prettier）を設定  
- [ ] T004 [P] ベースコンポーネントの作成  
       （`Layout.astro`, `AlgorithmStep.astro`, `ArrayVisualizer.astro`, `MathFormula.astro` など）（未作成の場合）

---

## フェーズ 2: 基盤 (Foundational / 事前必須)

**目的**: いずれのユーザーストーリーよりも先に必要となるコアインフラ

**⚠️ 重要**: このフェーズが完了するまで、ユーザーストーリーの実装を開始してはならない。

プロジェクトに応じて、次のようなタスクを調整・追加する:

- [ ] T010 必要であればデータ保存構造（例: ローカルストレージ or ファイル構成）の設計  
- [ ] T011 [P] 共通エラーハンドリング / ロギングの方針を決定し、共通ユーティリティを作成  
- [ ] T012 Motion One のアニメーションユーティリティを共通化（例: ステップ再生用のラッパー関数）  
- [ ] T013 KaTeX / Prism.js のグローバル設定（必要に応じて）  

**チェックポイント**:  
基盤が整い、ユーザーストーリー実装を並列に開始できる状態になっていること。

---

## フェーズ 3: User Story 1 - [タイトル] (Priority: P1) 🎯 MVP

**ゴール**: [このストーリーがユーザーにどんな価値を届けるかを 1〜2 行で記述]  
**独立テスト方法**: [このストーリー単体の動作確認方法を記述]

### User Story 1 のテスト (任意 / テストが要求される場合のみ) ⚠️

> **注意**: これらのテストは実装前に書き、最初は必ず FAIL することを確認する。

- [ ] T020 [P] [US1] [対象機能] のインタラクションテスト（例: Playwright）  
- [ ] T021 [P] [US1] 可視化と Algorithm Flow の同期を確認するテスト  

### User Story 1 の実装

- [ ] T022 [P] [US1] アルゴリズムページ `src/pages/algorithms/[algo].astro` の作成  
- [ ] T023 [P] [US1] Visualization 用コンポーネントの作成  
       （例: `src/components/[Algo]Visualizer.astro` または `.tsx`）  
- [ ] T024 [US1] Algorithm Flow セクションの実装（`AlgorithmStep` を用いる）  
- [ ] T025 [US1] TypeScript 実装コードの追加（10〜20 行、コメント最小限）  
- [ ] T026 [US1] Math セクション（`<details>` による折り畳み）の実装  
- [ ] T027 [US1] Playground へのリンク追加（存在する場合）  

**チェックポイント**:  
User Story 1 が単体で動作し、テストおよびドキュメントで検証可能な状態。

---

## フェーズ 4: User Story 2 - [タイトル] (Priority: P2)

**ゴール**: [このストーリーがユーザーにどんな価値を届けるか]  
**独立テスト方法**: [このストーリー単体の動作確認方法を記述]

### User Story 2 のテスト (任意) ⚠️

- [ ] T030 [P] [US2] [対象機能] のインタラクションテスト  
- [ ] T031 [P] [US2] US1 との連携が必要な場合、その結合動作を確認するテスト  

### User Story 2 の実装

- [ ] T032 [P] [US2] アルゴリズムまたは Playground 用ページの追加  
- [ ] T033 [US2] 必要なコンポーネント / ユーティリティの実装  
- [ ] T034 [US2] US1 との連携（必要な場合のみ）  

**チェックポイント**:  
User Story 1 と 2 がそれぞれ独立して動作し、必要であれば連携も確認できていること。

---

## フェーズ 5: User Story 3 - [タイトル] (Priority: P3)

**ゴール**: [このストーリーがユーザーにどんな価値を届けるか]  
**独立テスト方法**: [このストーリー単体の動作確認方法を記述]

### User Story 3 のテスト (任意) ⚠️

- [ ] T040 [P] [US3] [対象機能] のインタラクションテスト  
- [ ] T041 [P] [US3] セッション全体の流れに与える影響を確認するテスト  

### User Story 3 の実装

- [ ] T042 [P] [US3] 新規ページ / 既存ページの拡張  
- [ ] T043 [US3] 追加の可視化 / 補助コンポーネントの実装  
- [ ] T044 [US3] 必要なリファクタリング（重複コードの整理など）  

**チェックポイント**:  
すべてのユーザーストーリーが独立して動作し、個別にデモ可能な状態。

---

[必要に応じて、同様のパターンでフェーズを追加する]

---

## フェーズ N: 仕上げ & 横断的な改善 (Polish & Cross-Cutting Concerns)

**目的**: 複数のユーザーストーリーにまたがる改善

- [ ] T100 [P] ドキュメント整備（`docs/` や `specs/` の更新）  
- [ ] T101 コードのクリーンアップとリファクタリング  
- [ ] T102 パフォーマンス最適化（不要な再レンダリングや無駄なアニメーションの削減など）  
- [ ] T103 [P] 追加の単体テスト（要求がある場合）  
- [ ] T104 セキュリティ / 入力バリデーションの強化  
- [ ] T105 quickstart.md に記載された手順が実際に動作するかの検証  

---

## 依存関係と実行順序 (Dependencies & Execution Order)

### フェーズ間の依存関係

- **セットアップ (フェーズ 1)**: 依存なし。最初に実行。  
- **基盤 (フェーズ 2)**: セットアップ完了後に実行。すべてのユーザーストーリーの前提。  
- **ユーザーストーリー (フェーズ 3 以降)**: いずれもフェーズ 2 完了を前提とし、  
  - チームが複数人であれば並列に進行可能  
  - 1 人開発の場合は、優先度順 (P1 → P2 → P3) に実装  
- **仕上げ (最終フェーズ)**: すべての必要なユーザーストーリーが完了した後に実行。

### ユーザーストーリー間の依存関係

- **User Story 1 (P1)**: フェーズ 2 完了後に着手可能。他ストーリーへの依存は持たない想定。  
- **User Story 2 (P2)**: フェーズ 2 完了後に着手可能。US1 と連携する場合でも、単体でテスト可能であること。  
- **User Story 3 (P3)**: フェーズ 2 完了後に着手可能。US1/US2 と連携する場合でも、単体でテスト可能であること。  

### 各ユーザーストーリー内部

- テスト（含める場合）は実装前に書き、最初は FAIL することを確認する。  
- モデル / データ構造 → サービス / ロジック → ページ / UI の順で実装する。  
- コア機能の実装が完了するまで細かいリファクタリングに入りすぎない。  
- 各ストーリーが「完了」してから次の優先度へ進む。

### 並列実行の機会 (Parallel Opportunities)

- フェーズ 1 の [P] タスクは並列実行可能。  
- フェーズ 2 の [P] タスクも、フェーズ内で並列実行可能。  
- フェーズ 2 完了後、ユーザーストーリー同士は（チーム体制次第で）並列に進められる。  
- 各ストーリーのテストタスクのうち [P] が付いたものは並列実行可能。  
- 同一ストーリー内でも、別ファイルにまたがる [P] タスクは並列実行可能。  

---

## 並列実行の例: User Story 1

```bash
# User Story 1 のテスト（要求がある場合）をまとめて実行:
Task: "[US1] [対象機能] のインタラクションテスト"
Task: "[US1] 可視化と Algorithm Flow の同期を確認するテスト"

# User Story 1 で必要な可視化コンポーネントを並列に実装:
Task: "src/components/[Algo]Visualizer.astro を作成"
Task: "Motion One ベースのアニメーションユーティリティを追加"
```

---

## 実装戦略 (Implementation Strategy)

### MVP 優先 (User Story 1 のみをまず完成させる)

1. フェーズ 1（セットアップ）を完了させる  
2. フェーズ 2（基盤 / 事前必須）を完了させる — すべてのストーリーの前提  
3. フェーズ 3（User Story 1）を完了させる  
4. **停止して検証**: User Story 1 が単体で価値を提供できることを確認する  
5. 問題なければデプロイ / デモを実施

### 段階的デリバリー (Incremental Delivery)

1. セットアップ + 基盤を完了 → 「土台」が整った状態にする  
2. User Story 1 を追加 → テスト → デプロイ / デモ（MVP）  
3. User Story 2 を追加 → テスト → デプロイ / デモ  
4. User Story 3 を追加 → テスト → デプロイ / デモ  
5. 各ストーリーは、前のストーリーを壊さずに価値を上積みしていくこと。

### チーム開発時の並列戦略 (Parallel Team Strategy)

複数人で開発する場合:

1. チーム全員でフェーズ 1 + フェーズ 2 を完了させる  
2. 基盤が整ったら、以下のように分担する:
   - 開発者 A: User Story 1  
   - 開発者 B: User Story 2  
   - 開発者 C: User Story 3  
3. 各ストーリーは、独立して完成できる単位として扱い、最終的に統合する。

---

## メモ (Notes)

- [P] が付いたタスクは、**別ファイル** かつ **依存がない** 場合に並列実行してよい。  
- [Story] ラベルにより、タスクがどのユーザーストーリーに属するかを常に追跡できるようにする。  
- 各ユーザーストーリーは、単体で完了・テスト・デモ可能な状態を目指す。  
- テストを先に書き、実装前に FAIL することを確認する（テスト駆動を推奨）。  
- タスクまたは論理的なまとまりごとに、こまめにコミットする。  
- どのチェックポイントでも開発を一旦止めて、そこまでのストーリーが独立して動作するかを検証できるようにする。  
- 曖昧なタスク記述や、同一ファイルに対する競合しやすい変更、  
  ストーリー間の強すぎる依存関係は避けること。  


